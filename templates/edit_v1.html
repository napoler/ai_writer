<!DOCTYPE html>
<html>

<head>
  <!-- Standard Meta -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <!-- <link rel="stylesheet" type="text/css" href="/static/style.css"> -->
  <script src="https://cdn.staticfile.org/jquery/3.3.1/jquery.min.js"></script>
  <link crossorigin="anonymous" integrity="sha384-ATvSpJEmy1egycrmomcFxVn4Z0A6rfjwlzDQrts/1QRerQhR9EEpEYtdysLpQPuQ"
    href="//lib.baomitu.com/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet">
  <script crossorigin="anonymous" integrity="sha384-6urqf2sgCGDfIXcoxTUOVIoQV+jFr/Zuc4O2wCRS6Rnd8w0OJ17C4Oo3PuXu8ZtF"
    src="//lib.baomitu.com/semantic-ui/2.4.1/semantic.min.js"></script>
  <!-- 拖拽插件 -->


  <!-- <script src="/static/js/jquery-sortable-lists.min.js"></script> -->
  <!-- http://psfpro.github.io/bootstrap-html5sortable/ -->
  <!-- <script src="/static/js/jquery.sortable.min.js"></script> -->

  <!-- <script src="https://cdn.jsdelivr.net/npm/jquery-sortablejs@latest/jquery-sortable.js"></script> -->
  <script src="/static/js/jquery-sortable-min.js"></script>
  <!-- https://johnny.github.io/jquery-sortable/ -->
  <!-- https://johnny.github.io/jquery-sortable/ -->

  <script>


 //获取url中的参数
 function getUrlParam(name) {
            // var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
            // var r = window.location.search.substr(1).match(reg);  //匹配目标参数
            // if (r != null) return unescape(r[2]); return null; //返回参数值


            var url = window.location.search; //获取url中"?"符后的字串   
       var theRequest = new Object();   
       if (url.indexOf("?") != -1) {   
          var str = url.substr(1);   
          strs = str.split("&");   
          for(var i = 0; i < strs.length; i ++) {   
              //就是这句的问题
             theRequest[strs[i].split("=")[0]]=decodeURI(strs[i].split("=")[1]); 
             //之前用了unescape()
             //才会出现乱码  
          }   
       }   
       return theRequest[name];  

        }






    $(function () {

      var group = $("ol.serialization").sortable({
        group: 'serialization',
        delay: 500,
        onDrop: function ($item, container, _super) {
          var data = group.sortable("serialize").get();

          var jsonString = JSON.stringify(data, null, ' ');

          $('#serialize_output2').text(jsonString);
          _super($item, container);
        }
      });

      // // 句子
      // var group = $("ol#edit_tool").sortable({
      //     group: 'serialization',
      //     delay: 500,
      //     onDrop: function ($item, container, _super) {
      //       var data = group.sortable("serialize").get();
  
      //       var jsonString = JSON.stringify(data, null, ' ');
  
      //       $('#serialize_output2').text(jsonString);
      //       _super($item, container);
      //     }
      //   });

      // var content = $('#content').html();
    $('.kwd').click(function () {

       var content = $('#slist').html(content);
        var searchText = $(this).val();
        if (searchText.length == 0) {
            return false;
        }
        var regExp = new RegExp(searchText, 'g');
        var newHtml = content.replace(regExp, '<span id="result" style="background:yellow;color:red;">' + searchText + '</span>');
        $('#slist').html(newHtml);
        var X = $('#result').offset().top;
        var Y = $('#result').offset().left;
        window.scrollTo(X, Y);
    });
// 获取预测关键词
function fenci_get (text){

$.get(
        "/json/sentence/fenci",
        { text: text },
        function (data) {
          // ...
          console.log('预测结果', data)
          var textLong = ''
          // var textL = ''
          $.each(data.seg_list, function (key, value) {
            console.log(key + ": " + value);
            console.log(value);

            textLong = textLong + '<li id="word' + key +'" class="word remove-'+value.remove +' ui mini button word ">' + value.word + "</li>"

            // textL = textL +' '+ value.word

          })

          $("#edit_tool").html(textLong)
          $("#original").html(data.text)
          $('#msg').html('辅助预测加载成功')
 })
}


$(document).on('click', '.word', function () {
// 标记词语
var text  = $(this).text();
console.log(text);
console.log(text.length);
// console.log(times2('*', text.length));
// var new_text = times2('*', text.length)
var new_text = "##del##"+text+"##del##"
$(this).text(new_text).addClass("del").removeClass('word')


// 更新标记后的数据
text = find_to_text(".word")

$("#editing_juzi_edit").val(text)
nlp(text)
})


$(document).on('click', '#save_post-button', function () {
// 手动保存
save_post()
 
})

$(document).on('click', '#save_post', function () {
// 手动保存
save_post()
 
})
// 获取预测关键词
function fenci_update (text1,text2){

$.get(
        "/json/fenci_update",
        { 'text1': text1,
        'text2': text2,
         },
        function (data) {
          // ...
          console.log('fenci_update结果', data)
          // var textLong = ''
          // var textL = ''
          // $.each(data.items, function (key, value) {
          //   console.log(key + ": " + value);
          //   console.log(value);

          //   // textLong = textLong + '<li id="word' + key + '" class="ui mini button word ">' + value.word + "</li>"

          //   textL = textL +' '+ value.word

          // })

          // $("#calculate_keyword").val(data)
          $('#msg').html('句子提交成功')
 })



}

// 这里提交训练样本
$(document).on('click', '#fenci_update', function () {
        // $(".aClass li .button").click(function () {
          var text1=''
        var text2 = $('#edit_tool').text();

        fenci_update(text1,text2)

});
      /****
      点击语句添加到编辑列表
      
      *******/
      $(document).on('click', '.next_sentence', function () {
        // $(".aClass li .button").click(function () {

        var txt = $(this).addClass("red").text().replace(/(^s*)|(s*$)/g, "");

        console.log(txt)

        uuid = uuidv4()
        txt = txt.replace(/\s+/g, "");

        var ju = ' <li id="id-' + uuid + '">'
          + txt
          + '</li>'
        var id = $("#t_juzi").val();
        $('#' + id).after(ju);
        $(this).attr('disabled', 'disabled').removeClass('next_sentence');

      });
      /****
      点击语句添加到编辑列表
      
      *******/
      $(document).on('click', '.sentence', function () {
        // $(".aClass li .button").click(function () {

        var txt = $(this).addClass("red").text().replace(/(^s*)|(s*$)/g, "");
        $(this).removeClass('sentence');
        console.log(txt)

        uuid = uuidv4()
        txt = txt.replace(/\s+/g, "");

        var ju = ' <li  id="id-' + uuid + '">'
          + txt
          + '</li>'
        $("#edit-list").append(ju);



        // $.get(
        //   "/json/nlp",
        //   { text: txt },
        //   function (data) {
        //     // ...
        //     console.log('分词结果', data)
        //     var textLong = ''
        //     $.each(data.items, function (key, value) {
        //       console.log(key + ": " + value);
        //       console.log(value);
        //       pr = value.prob

        //       console.log('pr', pr);
        //       n = 0;
        //       // var k=3;
        //       switch (true) {
        //         case pr > 0.01:
        //           n = 1;
        //           console.log('等级：', n);
        //           break;
        //         case pr > 0.0001:
        //           n = 2;
        //           console.log('等级：', n);
        //           break;
        //         case pr > 0.000001:
        //           n = 3;
        //           console.log('等级：', n);
        //           break;
        //         case pr > 0.00000001:
        //           n = 4;
        //           console.log('等级：', n);
        //           break;
        //         case pr > 0.000000001:
        //           n = 5;
        //           console.log('等级：', n);
        //           break;
        //         default:
        //           n = 0;
        //           console.log('等级：', n);
        //         // case 5:
        //         //   n="Today it's Friday";
        //         //   break;

        //       }










        //       textLong = textLong + "<span class='gm gm" + n + "'>" + value.word + "</span>"


        //     });
        //     pplClass = 'ppl_0'
        //     if (data.ppl > 1000) {
        //       pplClass = 'ppl_2'
        //     } else if (data.ppl > 500) {
        //       pplClass = 'ppl_1'

        //     }

        //     $('#id-' + uuid + ' .edit_box_form').append(
        //       '<div class="column">' +
        //       'ppl评分:' + data.ppl +
        //       '<div class="ppl ' + pplClass + '">' +
        //       textLong +
        //       "</div>" + "</div>"

        //     );


        //     // return data
        //   },
        //   "json"
        // );
        // https://johnny.github.io/jquery-sortable/
        // txt.appendto(this).p;
        // $('.list-group-sortable-connected').sortable({
        //   placeholderClass: 'list-group-item',
        //   connectWith: '.connected'
        // });
        // 最后移除class


      });




      // $(document).on('click', '.edit-juzi', function () {

      //   var juzi = $(this).parent().val();

      //   $('.dimmer').dimmer('show');


      // });
  
      // function get_url_content(url) {

      //   $.get(
      //     "/json/url_content",
      //     {
      //       url: url,

      //     },
      //     function (data) {

      //       console.log(data);
      //       if (data.sentence.length > 2) {




      //         textLong = '<div class ="article" >' + ''
      //         for (var item in data.keyphrases) {
      //           console.log("obj." + item + data.keyphrases[item]);
      //           textLong = textLong + "关键短语." + item
      //         }






      //         var summarys = new Array();
      //         for (item in data.summary) {
      //           console.log(data.summary[item]['sentence'])
      //           // summarys.push(data.summary[item]['sentence'])
      //           summarys.push(data.summary[item]['index'])

      //         }

      //         console.log("summarys." + summarys);




      //         // 这里是构建文章
      //         var sentences = ''
      //         for (item in data.sentence) {
      //           console.log('item', item)
      //           console.log('isInArray', isInArray(summarys, item))


      //           var cl = 'sentence'
      //           if (isInArray(summarys, item)) {
      //             console.log('摘要选择', item)
      //             cl = 'sentence summary'
      //           }




      //           sentences = sentences + '<span class ="' + cl + '" id ="">'
      //             + data.sentence[item]
      //             + '</span>'




      //         }


      //         textLong = textLong + sentences

      //         textLong = textLong + ' <div class="">';
      //         for (var item in data.keywords) {
      //           // console.log("summarys." + item +value.keyphrases[item]['sentence']);
      //           // console.log("summarys." + item + value.keywords[item]['word']);
      //           textLong = textLong + '<span>'
      //             + data.keywords[item]['word']
      //             //  +'</div><button class="ui button use">'
      //             //   +'  使用</button></li>'
      //             + '  ,</span>'

      //         }
      //         textLong = textLong + ' </div>';

      //         $('#slist').prepend(textLong);
      //       }
      //     })

      // }



      // function item_html(data) {
      //   //  获取到的搜索转换成html

      //   console.log(data);
      //   if (data.sentence.length > 2) {




      //     textLong = '<div class ="article" >' + ''

      //     textLong = textLong + ' <div class="keywords">';
      //     for (var item in data.keywords) {
      //       // console.log("summarys." + item +value.keyphrases[item]['sentence']);
      //       // console.log("summarys." + item + value.keywords[item]['word']);
      //       textLong = textLong + '<span>'
      //         + data.keywords[item]['word']
      //         //  +'</div><button class="ui button use">'
      //         //   +'  使用</button></li>'
      //         + '  ,</span>'

      //     }
      //     textLong = textLong + ' </div>';

      //     for (var item in data.keyphrases) {
      //       console.log("obj." + item + data.keyphrases[item]);
      //       textLong = textLong + "关键短语." + item
      //     }






      //     var summarys = new Array();
      //     for (item in data.summary) {
      //       console.log(data.summary[item]['sentence'])
      //       // summarys.push(data.summary[item]['sentence'])
      //       summarys.push(data.summary[item]['index'])

      //     }

      //     console.log("summarys." + summarys);




      //     // 这里是构建文章
      //     var sentences = ''
      //     for (item in data.sentence) {
      //       console.log('item', item)
      //       console.log('isInArray', isInArray(summarys, item))


      //       var cl = 'sentence'
      //       if (isInArray(summarys, item)) {
      //         console.log('摘要选择', item)
      //         cl = 'sentence summary'
      //       }




      //       sentences = sentences + '<span class ="' + cl + '" id ="">'
      //         + data.sentence[item]
      //         + '</span>'




      //     }


      //     textLong = textLong + sentences + ' </div>';



      //     $('#slist').prepend(textLong);
      //   }


      // }




      // $(document).on('click', '.prediction-button', function () {

      //   var keyword = $('#search-input').val();
      //   console.log('搜索关键词:', keyword);
      //   // json/search?text=柯基犬%20小短腿&limit=2
      //   $.get(
      //     "/json/search",
      //     {
      //       text: keyword,
      //       limit: 10
      //     },
      //     function (data) {
      //       // ...
      //       console.log('搜索结果：', data)
      //       var textLong = ''
      //       $.each(data, function (key, value) {

      //         console.log(key + ": " + value['url']);
      //         console.log(value);
      //         // textLong = '' + '开始'

      //         get_url_content(value['url'])

      //       },
      //         "json"
      //       );

      //     });
      // });


      // 搜索

      // #slist
      $(document).on('click', '#search-button', function () {
       
        $("#slist_msg").html('加载中...')


        var keyword = $('#search-input').val();
        console.log('搜索关键词:', keyword);

        $.get(
          "/json/search_pre",
          {
            text: keyword,
            limit: 10
          },
          function (data) {
            // ...
            console.log('搜索结果：', data)
            $("#slist_msg").html('搜索完成')
            var textLong = ''
            $.each(data, function (key, value) {

              console.log(key + ": " + value['url']);
              console.log(value);
              // textLong = '' + '开始'

              // get_url_content(value['url'])
              item_html_v1(value)

            },
              "json"
            );

          });
      });




      // 聚焦语句编辑器时候执行
      // $(document).on('focus', '.editing_juzi_edit', function () {

      //   console.log('开始编辑语句')
      //   $(this).addClass("bor");

      // });

      // $(document).on('blur', '.editing_juzi_edit', function () {
      //   // 停止编辑
      //   $(this).removeClass("bor");
      //   text = $(this).val();
      //   nlp(text)

      // });
      // 失去焦点时候执行
      // $(document).on('blur', '.edit_box_textarea', function () {

      // // $(document).on("input propertychange", ".edit_box_textarea", function () {
      // $(document).on("click", ".edit_box_form .button", function () {
      //   console.log('失去焦编辑语句')
      //   $(this).removeClass("bor");

      //   var t = $(this)
      //   var id = $(this).parent().find('.edit_box_textarea');

      //   console.log('id', id)
      //   var txt = id.val();
      //   // id.parent().parent().parent().parent().children('review').text(txt)
      //   id.css("color", "blue");

      //   // 提交更新
      //   $('#content-review .content').empty();

      //   $('#content-review .content').append('<ol></ol>');
      //   $('#edit-list .item .edit_box_textarea').each(function () {
      //     // doSomethingWith($(this).text());
      //     // 依次对每个 div 执行 doSomethingWith()，
      //     // 将当前 DIV 中的文本作为参数
      //     var text = $(this).val();
      //     console.log(text);
      //     $('#content-review .content ol').append('<li><a href="">' + text + '。</a></li>');
      //   });
























      //   $.get(
      //     "/json/nlp",
      //     { text: txt },
      //     function (data) {
      //       // ...
      //       console.log('分词结果', data)
      //       var textLong = ''
      //       $.each(data.items, function (key, value) {
      //         console.log(key + ": " + value);
      //         console.log(value);
      //         //   if (value.word.replace(/(^s*)|(s*$)/g, "").length==0){

      //         //   }else{
      //         //      textLong=textLong+"<span>"+value.word+"</span>"
      //         // }
      //         pr = value.prob





      //         console.log('pr', pr);
      //         n = 0;
      //         // var k=3;
      //         switch (true) {
      //           case pr > 0.01:
      //             n = 1;
      //             console.log('等级：', n);
      //             break;
      //           case pr > 0.0001:
      //             n = 2;
      //             console.log('等级：', n);
      //             break;
      //           case pr > 0.000001:
      //             n = 3;
      //             console.log('等级：', n);
      //             break;
      //           case pr > 0.00000001:
      //             n = 4;
      //             console.log('等级：', n);
      //             break;
      //           case pr > 0.000000001:
      //             n = 5;
      //             console.log('等级：', n);
      //             break;
      //           default:
      //             n = 0;
      //             console.log('等级：', n);
      //           // case 5:
      //           //   n="Today it's Friday";
      //           //   break;

      //         }










      //         textLong = textLong + "<span class='gm gm" + n + "'>" + value.word + "</span>"

      //       });
      //       pplClass = 'ppl_0'
      //       if (data.ppl > 1000) {
      //         pplClass = 'ppl_2'
      //       } else if (data.ppl > 500) {
      //         pplClass = 'ppl_1'

      //       }
      //       console.log('分词结果', textLong)
      //       id.addClass(pplClass + " ppl")


      //       //      '<div class="one wide column">' +
      //       //   '<div class="review">' +
      //       //  '评分:'+

      //       //   '</div>' +
      //       //   '</div>' +


      //       n = 0;
      //       // var k=3;
      //       switch (true) {
      //         case data.ppl > 0:
      //           n = 1;
      //           console.log('等级：', n);
      //           break;
      //         case data.ppl > 500:
      //           n = 2;
      //           console.log('等级：', n);
      //           break;
      //         case data.ppl > 1000:
      //           n = 3;
      //           console.log('等级：', n);
      //           break;
      //         case data.ppl > 2000:
      //           n = 4;
      //           console.log('等级：', n);
      //           break;
      //         case data.ppl > 5000:
      //           n = 5;
      //           console.log('等级：', n);
      //           break;
      //         default:
      //           n = 0;
      //           console.log('等级：', n);
      //         // case 5:
      //         //   n="Today it's Friday";
      //         //   break;

      //       }



















      //       t.parent().parent().parent().find('.review').text('评分:' + data.ppl).addClass('gm' + n);
      //       t.after(
      //         '<div class="column">' +
      //         'ppl1评分:' + data.ppl +
      //         '<div class="ppl ' + pplClass + '">' +
      //         textLong +
      //         "</div>" + "</div>"

      //       );


      //     });





      // });









      // 获取预览text文章
      $(document).on('click', '#totext', function () {
        $('#content-review .content').empty();

        // $('#content-review .content').append('<ol></ol>');
        $('#edit-list li').each(function () {
          // doSomethingWith($(this).text());
          // 依次对每个 div 执行 doSomethingWith()，
          // 将当前 DIV 中的文本作为参数
          var text = $(this).text();
          console.log(text);
          
       
          $('#content-review .content').append('<span >' + text + '。</span>');
        });
        var t =$('#content-review .content').text();
        l = t.length;
        $('#totext_len').text(l)


      });

// 获取预测关键词
function get_calculate_keyword (text){

  $.get(
          "/json/calculate_keyword",
          { text: text },
          function (data) {
            // ...
            console.log('分词结果', data)
            // var textLong = ''
            // var textL = ''
            // $.each(data.items, function (key, value) {
            //   console.log(key + ": " + value);
            //   console.log(value);

            //   // textLong = textLong + '<li id="word' + key + '" class="ui mini button word ">' + value.word + "</li>"

            //   textL = textL +' '+ value.word

            // })

            $("#calculate_keyword").val(data)
   })



}



$(document).on('click', '#editing_juzi_edit_ppl .gm', function () {

  var text  = $(this).text();
  var calculate_keyword = $('#calculate_keyword').val();

  calculate_keyword = calculate_keyword + ' '+ text;
  $('#calculate_keyword').val(calculate_keyword);

})



      // 点击切换开启编辑dblclick
      $(document).on('click', '#edit-list li', function () {
        // #移除之前的状态
        $('#edit-list li').removeClass("editing")
        //  自动更新之前修改的数据
        var t_juzi = $('#t_juzi').val();
        if (t_juzi) {
          // var  t_juzi_text = $('#editing_juzi').text();
          var t_juzi_text = $('#editing_juzi_edit').val();

          $('#' + t_juzi).text(t_juzi_text).removeClass('editing').addClass('edited');
   

        }
        $('#calculate_keyword').val("");
        $('#calculate_list').empty();


        var state = $(this).data('state');

        switch (state) {
          case 1:
          case undefined:
             $(this).addClass('editing'); 
             $(this).data('state', 2); 

             
             var id = $(this).attr('id');
              $('#t_juzi').val(id);
              var text = $(this).text();
              $("#editing_juzi_edit").val(text)
              // $("#edit_tool").empty()
              $("#edit_tool").text('语句简写分析中...')
              // 获取预测关键词
              get_calculate_keyword(text)

              // 执行句子简写预测
              fenci_get (text)
              nlp(text)


               // 自动执行预测下一句
              get_next_search(text)
             break;




          case 2: 
          // 移除之前的编辑状态
          //  text2
          //  fenci_updata(text1,text2)
           $(this).removeClass('editing').addClass('edited');
           $(this).data('state', 1); 
           $('#t_juzi').val('')
           break;
        }

        // t_juzi


        // var pid = $(this).prev().attr('id');
        // $('#p_juzi1').val(pid);

        // var nid = $(this).next().attr('id');
        // $('#n_juzi1').val(nid);


        console.log(text)



          // 自动执行预测下一句
          // get_next_search(text)



      });

      function find_to_text(class_name){
        // 获取未标记的文字
        // 输入过滤规则 class or id
      text= ''
      $(class_name).each(function ( index,element){

        text = text+$(this).text()

      })
      return text

      }

$(document).ready(function(){
    // 加载时候执行
	//do something
  var id = getUrlParam('id')
  console.log(id)
  $("#save_post_title-input").val(id)


  // 自动获取之前保存的数据
  $.post("/json/get/post", { 'id': id})
    .done(function (data) {
      // alert( "Data Loaded: " + data );
      console.log(data)
      // if (data.state) {
      //   $("#msg").html('已经保存!')
      // }
      console.log("加载成功!")
      // $("#msg").html(data.msg)
      // get_article_plus

      // uuid = uuidv4()
      //   txt = txt.replace(/\s+/g, "");

      //   var ju = ' <li  id="id-' + uuid + '">'
      //     + txt
      //     + '</li>'
      //   $("#edit-list").append(ju);
      $.each(data.data, function (key, value) {
        uuid = uuidv4()
       var ju = ' <li  id="id-' + uuid + '">'
          + value
          + '</li>'
          $("#edit-list").append(ju);
       });




    });

    if (id == undefined) 
  { 
  // alert('输入标题保存'); 

  $('#add-title-modal').modal('show');

  return ''
  }
})
 
function save_post(){

  // 保存编辑的文档
  var text= ''
  // var id = getUrlParam('id')
  var title = $("#save_post_title-input").val()
    console.log('title:'+title)

    
    id=title
    if (id.length == 0) 
  { 
  // alert('输入标题保存'); 

  $('#add-title-modal').modal('show');

  return ''
  }
  console.log(id)

  window.history.pushState({},0,'http://'+window.location.host+'/p/edit?id='+id);   
  // if (id ==null){
   
  //   // id = new Date().getTime();
  //   // id = new Date().toUTCString();
  //   window.history.pushState({},0,'http://'+window.location.host+'/p/edit?id='+id);      
  // }

  if (id.length == 0) 
  { 
  // alert('输入标题保存'); 
  $('#add-title-modal').modal('show');
  }

  $("#edit-list li").each(function ( index,element){
    var it= $(this).text()
    text= text+it+'。\n'

    
  })

  $.post("/json/save/post", { 'id': id, 'text': text })
    .done(function (data) {
      // alert( "Data Loaded: " + data );
      console.log(data)
      if (data.state) {
        $("#msg").html('已经保存!')
      }
      console.log("已经保存!")
      // $("#msg").html(data.msg)
    });

}
      // 每 1000 毫秒执行 clock() 函数
// var int=self.setInterval("save_post()",1000);
// $('body').everyTime('1s',save_post);

setInterval(function() {
    // refresh list
    save_post()
}, 120000)

 

function nlp(text){
// 获取
  
  // $.get(
  //         "/json/nlp",
  //         { text: text },
  //         function (data) {
  //           // ...
  //           console.log('分词结果', data)
  //           var textLong = ''
  //           var textL = ''
  //           $.each(data.items, function (key, value) {
  //             console.log(key + ": " + value);
  //             console.log(value);

  //             textLong = textLong + '<li id="word' + key + '" class="ui mini button word ">' + value.word + "</li>"

  //             textL = textL + value.word

  //           })

  //           $("#editing_juzi_edit").val(textL)
  //           $("#editing_juzi").html(textLong)
  //           // $('#editing_juzi').sortable({});


  //         })


        // 执行nlp预测
  $.get(
          "/json/nlp",
          { text: text },
          function (data) {
            // ...
            console.log('分词结果', data)
            var textLong = ''
            $.each(data.items, function (key, value) {
              console.log(key + ": " + value);
              console.log(value);
              pr = value.prob

              console.log('pr', pr);
              n = 0;
              // var k=3;
              switch (true) {
                case pr > 0.01:
                  n = 1;
                  console.log('等级：', n);
                  break;
                case pr > 0.0001:
                  n = 2;
                  console.log('等级：', n);
                  break;
                case pr > 0.000001:
                  n = 3;
                  console.log('等级：', n);
                  break;
                case pr > 0.00000001:
                  n = 4;
                  console.log('等级：', n);
                  break;
                case pr > 0.000000001:
                  n = 5;
                  console.log('等级：', n);
                  break;
                default:
                  n = 0;
                  console.log('等级：', n);
                // case 5:
                //   n="Today it's Friday";
                //   break;

              }

              textLong = textLong + "<span class='gm gm" + n + "'>" + value.word + "</span>"


            });
            // pplClass = 'ppl_0'
            // if (data.ppl > 1000) {
            //   pplClass = 'ppl_2'
            // } else if (data.ppl > 500) {
            //   pplClass = 'ppl_1'

            // }

            // $('#id-' + uuid + ' .edit_box_form').append(
            //   '<div class="column">' +
            //   'ppl评分:' + data.ppl +
            //   '<div class="ppl ' + pplClass + '">' +
            //   textLong +
            //   "</div>" + "</div>"

            // );
            $('#editing_juzi_edit_ppl_value .value').html(data.ppl)
            $('#editing_juzi_edit_ppl').html(textLong);

            
            // return data
          },
          "json"
        );



}






      // 单击单词
      // 进入单词编辑
      // $(document).on('click', '.word', function () {
      //   // #移除之前的状态
      //   $('.word').removeClass("red")

      //   var state = $(this).data('state');
      //   switch (state) {
      //     case 1:
      //     case undefined: $(this).addClass('red'); $(this).data('state', 2); break;
      //     case 2: $(this).removeClass('red'); $(this).data('state', 1); break;
      //   }
      //   var id = $(this).attr('id');
      //   var word = $(this).text();

      //   $('#wordid').val(id);
      //   $('#word_text').val(word);





      // });

    $(document).on('click', '#nlp', function () {
      // 测试预测
        // #移除之前的状态
        var text = $('#editing_juzi_edit').val()
        nlp(text)
 

      });

      // 添加新语句
      $(document).on('click', '#add_juzi_edit_btn', function () {

        text = $('#add_juzi_edit').val()
        uuid = uuidv4()
        // $('#'+id).text(text);
        var ju = ' <li id="id-' + uuid + '">'
          + text
          + '</li>'
        $("#edit-list").append(ju);
      });

      // 修正为新的单词
      $(document).on('click', '#up', function () {
        // #移除之前的状态
        var id = $('#wordid').val()
        var text = $('#word_text').val()

        $('#' + id).text(text);
      });

      // //添加到之前
      // $(document).on('click', '#addpre', function () {
      //   // #移除之前的状态
      //   var id = $('#wordid').val()
      //   var text = $('#word_text').val()
      //   timestamp = new Date().getTime()
      //   $('#' + id).before('<li id="word' + timestamp + '" class="ui mini button word">' + text + '</li>');

      // });
      // // 添加到之后
      // $(document).on('click', '#addnext', function () {
      //   // #移除之前的状态
      //   var id = $('#wordid').val()
      //   var text = $('#word_text').val()
      //   timestamp = new Date().getTime()
      //   $('#' + id).after('<li id="word' + timestamp + '" class="ui mini button word">' + text + '</li>');

      // });


      // // 删除当前元素
      // $(document).on('click', '#remove', function () {
      //   // #移除之前的状态
      //   var id = $('#wordid').val()
      //   var text = $('#word_text').val()
      //   timestamp = new Date().getTime()


      //   var next_id = $('#' + id).next().attr('id');
      //   // 默认选择下一个单词
      //   var word = $('#' + next_id).text();
      //   $('#wordid').val(next_id);
      //   $('#word_text').val(word);
      //   $('#' + next_id).addClass("red")


      //   $('#' + id).remove();

      // });


      // 删除当前语句
      $(document).on('click', '#del_s', function () {
        // #移除之前的状态
        var id = $('#t_juzi').val()
        // var text= $('#word_text').val()
        // timestamp=new Date().getTime()


        // var next_id = $('#'+id).next().attr('id');
        // // 默认选择下一个单词
        // var word = $('#'+next_id).text();
        // $('#wordid').val(next_id);
        // $('#word_text').val(word);
        // $('#'+next_id).addClass("red")

        $('#' + id).remove();

      });


      // 预测这个单词
      $(document).on('click', '#mask', function () {
        // #移除之前的状态
        var id = $('#wordid').val()
        var text = $('#word_text').val()

        timestamp = new Date().getTime()
        $('#' + id).text(' [MASK] ');















      });

      $(document).on('click', '#used', function () {
        // 标记文章已经发布
        var id=getUrlParam('id')
        $.get(
        "/json/move_used",
        {
          'id': id,

        },
        function (data) {
          alert("已经标记发布")

          // console.log(data);
          // if (data.sentence.length > 2) {
          //   // for (item in data.sentence) {
          //   //             console.log('语句为', item)
          //   //             data.summary[item]['sentence']
          //   // }
          //   // var juzi = $('#editing_juzi').text()
          //   var juzi = $('#editing_juzi_edit').val();

          //   get_next_sentence_p(data.text, juzi)
          // }
        })

})
      // 进行改错
      $(document).on('click', '#gaicuo', function () {
        // #移除之前的状态
        // var id= $('#wordid').val()
        // var text= $('#word_text').val()

        // timestamp=new Date().getTime()
        // var text2 = $('#editing_juzi').text();
        var text2 = $('#editing_juzi_edit').val();
        var pre_text_id = $('#t_juzi').val();
        var text1 = $('#' + pre_text_id).prev().text();


        $.post("http://127.0.0.1:8110/json/sentence/gaicuo", { 'text1': text1, 'text2': text2 })
          .done(function (data) {
            // alert( "Data Loaded: " + data );
            console.log(data)
            if (data.msg) {
              $("#msg").html(data.msg)
            }
            // $("#prediction_list").append("</hr><ul></ul>")
            // var textLong=''
            // $.each( data.data, function( key, value ) {
            //   console.log(value)
            //   textLong=textLong+"<li>"+value+"</li>"


            // });
            // $("#prediction_list ul").append(textLong)
          });




      });












    });
    
    $(document).on('click', '#editing_juzi_edit_ppl .gm', function () {

      var k = $(this).text();
      console.log(k)
      var calculate_keyword = $('#calculate_keyword').val();
      var new_calculate_keyword = calculate_keyword +" "+k 
      console.log(calculate_keyword)
      $('#calculate_keyword').val(new_calculate_keyword);




    })
    // 预测下一句
    $(document).on('click', '#next', function () {
      
      // #移除之前的状态
      // var id= $('#wordid').val()
      // var text= $('#word_text').val()

      // timestamp=new Date().getTime()
      // var text2 = $('#editing_juzi').text();
      var text2 = $('#editing_juzi_edit').val();
      
      // var pre_text_id = $('#t_juzi').val();
      // var text1 = $('#'+pre_text_id).prev().text();
      var calculate_keyword = $('#calculate_keyword').val();
      get_next_search(text2, calculate_keyword)
 

    });

 

    // 预测下一句的搜索
    function get_next_search(text, calculate_keyword) {
      $("#calculate_list_msg").html('预测中...')
      $.get(
        "/json/calculate",
        {
          'text': text,
          'keyword': calculate_keyword,
          num: 10
        },
        function (data) {
          // ...
          console.log('搜索结果：', data)
          $("#calculate_list_msg").html(data.msg)
          
          // $("#calculate_keyword").val(data.keyword)
          // var textLong = ''
          calculate_items(data.next_lines_top)



          $.each(data.article, function (key, value) {
            // 将内容添加到搜索结果
            item_html_v1(value)
          },
            "json"
          );


        });

    }

    function item_html_v1(data) {
      //  获取到的搜索转换成html
     if( $('.article').data('md5')==data.md5){
       console.log($('.article').data('md5'))
       console.log(data.md5)
      console.log('已经存在');
       return 
     }
     
      console.log(data);
      if (data.sentence.length > 2) {




        textLong = '<div class ="article" data-md5 ="'+data.md5+'" >' + ''

        textLong = textLong + ' <div class="keywords">';
        var keywords = $("#search-tags").text();
        for (var item in data.keywords) {
          // console.log("summarys." + item +value.keyphrases[item]['sentence']);
          // console.log("summarys." + item + value.keywords[item]['word']);
          textLong = textLong + '<span class="kwd">'
            + data.keywords[item]['word']
            //  +'</div><button class="ui button use">'
            //   +'  使用</button></li>'
            + '  ,</span>'
            keywords = keywords +','+ data.keywords[item]['word']

        }
        $("#search-tags").html(keywords);
        textLong = textLong + ' </div>';


        var keyphrases = $("#search-keyphrases").text();
        for (var item in data.keyphrases) {
          console.log("obj." + item + data.keyphrases[item]);
          textLong = textLong + ','+data.keyphrases[item]
          keyphrases = keyphrases+','+data.keyphrases[item]
        }


        $("#search-keyphrases").html(keyphrases);






        var summarys = new Array();
        for (item in data.summary) {
          console.log(data.summary[item]['sentence'])
          // summarys.push(data.summary[item]['sentence'])
          summarys.push(data.summary[item]['index'])

        }

        console.log("summarys." + summarys);




        // 这里是构建文章
        var sentences = ''
        for (item in data.sentence) {
          console.log('item', item)
          console.log('isInArray', isInArray(summarys, item))


          var cl = 'sentence'
          if (isInArray(summarys, item)) {
            console.log('摘要选择', item)
            cl = 'sentence summary'
          }




          sentences = sentences + '<span data-line ="'+item+'" class ="' + cl + ' sentence'+item+'" id ="">'
            + data.sentence[item]
            + '</span>'




        }


        textLong = textLong + sentences + ' </div>';


      
        $('#slist .loader').remove();
        $('#slist').prepend(textLong);
      }


    }

    // 展现文章
    $(document).on('click', '.show-yw', function () {
      // $('.article').data('md5')==data.md5
     var md5 =  $(this).data('md5');

      $(".article").each(function ( index,element){
		var value =$(this).data("md5");
    if (value ===md5){
    var html = $(this).html()
        $('#yw-modal .article').empty().html(html)

    } 
    });
    var line = $(this).data("line");
    var pre_line = $("#editing_juzi_edit").val()
    $('#yw-modal .pre_line').text(pre_line)
    $('#yw-modal .article .sentence'+line).addClass('find');
    // $("#yw-modal .article span")
    // $(this).each(function ( index,element){
    // 		var value = $(this).data("line");
    //     // if (value ===line){
          

    //     // }
    
    
    // });




      $('#yw-modal').modal('show');
    


    })


    // 添加url text
    $(document).on('click', '#show_add_url', function () {

      $('#url_text-modal').modal('show');
    
    })

  // 添加url text
  $(document).on('click', '#url_text-modal .submit', function () {


   var url= $("#url_text-modal .url").val()
   var kwd= $("#url_text-modal .kwd").val()
   if(url.length>0){
    add_url(url)
   }

   if(kwd.length>0){
    baidu_kwd(kwd)
   }



// $('#url_text-modal').modal('show');



})






  // 点击搜索结果 自动获取内容
  $(document).on('click', '#url_text-modal .baidu_list dt span', function () {
    // $(this).data('url')
var url= $(this).data('url')
// var kwd= $("#url_text-modal .kwd").val()
if(url.length>0){
 add_url(url)
}
 

})





function baidu_kwd(kwd){
  // 执行百度搜索
  $.get(
  "/json/search_baidu",
  {
    'keyword': kwd,
    // 'keyword': calculate_keyword,
    // num: 10
  },
  function (data) {
    // ...
    console.log('搜索结果：', data)
    $("#calculate_list_msg").html(data.msg)
    
    // $("#calculate_keyword").val(data.keyword)
    // var textLong = ''
    // calculate_items(data.next_lines_top)
    // item_html_v1(data.data)

    // var html = $("#slist > div.article:nth-child(1)").html()
    
    // $("#url_text-modal .article").html(html)
    var html='<dl>'
    $.each(data.data, function (key, value) {
      // 将内容添加到搜索结果
     
      html= html+'<dt><span data-url="'+value['url']+'" class="title">'+value['title']+'</span></dt>'
      html= html+'<dd>'+value['text']+'</dd>'
   
    },
      "json"
    );

    html=html+'</dl>'
    $('.baidu_list').html(html)



  });
}
function add_url(url){

  // 通过url获取素材
  $.get(
  "/json/get_url",
  {
    'url': url,
    // 'keyword': calculate_keyword,
    // num: 10
  },
  function (data) {
    // ...
    console.log('搜索结果：', data)
    $("#calculate_list_msg").html(data.msg)
    
    // $("#calculate_keyword").val(data.keyword)
    // var textLong = ''
    // calculate_items(data.next_lines_top)
    item_html_v1(data.data)

    var html = $("#slist > div.article:nth-child(1)").html()
    
    $("#url_text-modal .article").html(html)

    // $.each(data.data, function (key, value) {
    //   // 将内容添加到搜索结果
    //   item_html_v1(value)
    // },
    //   "json"
    // );




  });



}

    function calculate_items(items) {
      var otext=$("#editing_juzi_edit").val();
      // 创建预测列表 #calculate_list
      var textLong = '<ol class ="serialization">'
      $.each(items, function (key, value) {
        var next_sentence_class =''
        if(value['line_to_check'] ==otext){
          next_sentence_class='original'
        }
        // console.log(key + ": " + value['url']);
        console.log(value);
        textLong = textLong + '<li>预测指数:' + value['next_line_prediction'] + ' <button data-line="'+value['line_number']+'" data-md5="'+value['original_text_md5']+'" class="ui button show-yw">原文</button></br>  <span class="next_sentence '+next_sentence_class+'">' + value['line_to_check'] + '</span></li>'


      },
        "json"
      );

      textLong = textLong + "</ol>"
      $('#calculate_list').empty();
      $("#calculate_list").html(textLong)
      //  $('#calculate_list').sortable({});
    }










    function get_next_content(url) {

      $.get(
        "/json/url_content",
        {
          url: url,

        },
        function (data) {

          console.log(data);
          if (data.sentence.length > 2) {
            // for (item in data.sentence) {
            //             console.log('语句为', item)
            //             data.summary[item]['sentence']
            // }
            // var juzi = $('#editing_juzi').text()
            var juzi = $('#editing_juzi_edit').val();

            get_next_sentence_p(data.text, juzi)
          }
        })

    }



  // 点击文章自动 排序
$(document).on('click', '#auto_sort', function () {

// var text= $('#edit-list').text()
var text=''
$('#edit-list li').each(function () {

           text = text+$(this).text()+'。';
        
        });
       var id =getUrlParam('id')
get_auto_sort(text,id) 


})

function get_auto_sort(text,id) {


$.post("/json/auto_sort", { 'aid': id, 'text': text  })
  .done(function (data) {
    // alert( "Data Loaded: " + data );
    console.log(data)
    location.reload();
  });

}












    function get_next_sentence_p(text, juzi) {


      $.post("http://127.0.0.1:8110/json/sentence/prediction", { 'text': text, 'sentence': juzi })
        .done(function (data) {
          // alert( "Data Loaded: " + data );
          console.log(data)
          if (data.msg) {
            $("#msg").html(data.msg)
          }
          var textLong = '<div class="article"><ol>'

          $.each(data.data, function (key, value) {
            // if(value['next_line_prediction']>3){
            textLong = textLong + "<li>" + value['line_number'] + ": " + value['next_line_prediction'] + "</br><span class ='sentence'>" + value['line_to_check'] + "</span></li>"
            // }



          });

          textLong = textLong + '</ol></div>'
          $('#slist').prepend(textLong);

        });

    }

    function isInArray(arr, value) {
        // console.log(arr)
        value = Number(value)
        for (var i = 0; i < arr.length; i++) {
          // console.log(arr[i])
          // console.log(i)
          // console.log(value)
          if (value === arr[i]) {
            return true;
          }
        }
        return false;
      }

    function uuidv4() {
      return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>
        (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
      )
    }

// console.log(uuidv4());

  </script>

  <style>
.modal {
 
    overflow-y: auto; 
    padding: 50px;
    width: 86%;
}

#url_text-modal .baidu_list dt span{
  padding: 5px;
    font-size: 20px;
    display: block;
    /* border-top: 2px #ccc solid; */
}
#url_text-modal .baidu_list dt{
  margin-top: 5px;
    background: #dfe6e3;
}
ol#edit_tool {
    margin-left: 0;
    padding: 0;
}
li.word {
    padding: 5px 10px !important;
    margin: 2px;
}
#edit_tool li.remove-Yes{

background: #ef9b9b;

    }

    .find{
      background: #dcf31d;
      border: 4px solid #dcf31d;
    }
    .listsClass li {
      display: block;
      margin: 5px;
      border: 1px solid #ccc;
      padding: 3px 5px;
      border-radius: 3px;
      border-left: 50px solid #ececec;
    }

    #sortableListsPlaceholder {
      background: #ececec
    }


    ul.aClass li {
      padding: 5px;
      border: 1px solid #ccc;
      margin: 2px;
    }

    .used {
      background: #ccc;
    }

    .juzi li {
      display: inline-block !important;
      margin: 2px 5px;
      border: 1px solid #ccc;
      padding: 3px 5px;
      border-radius: 3px;
      border-left: 1px solid #ececec;
    }

    div#edit-list {
      /* height: 600px;
      overflow-y: auto; */
    }

    .editing {
      border: 1px solid #36d65c;

    }

    .ppl {
      border: 2px solid;
      padding: 4px;
    }

    .ppl_0 {
      border-color: #36d65c !important;
      ;
    }

    .ppl_1 {
      border-color: rgba(236, 221, 7, 0.87) !important;
      ;
    }

    .ppl_2 {
      border-color: rgba(247, 46, 12, 0.87) !important;
      ;
    }

    .review {
      text-align: center;
      padding: 10px;
      font-size: 12px;
      overflow: hidden;
    }
    .gm-dengji .gm {
      display: inline-block;
      width: 30px;
      height: 12px;
    }
    .gm {
      display: inline-block;
 
    }

    .gm1 {
      background-color: rgb(221, 225, 233);
    }

    .gm2 {
      background-color: rgb(111, 234, 147);
    }

    .gm3 {
      background-color: rgb(234, 219, 111);
    }

    .gm4 {
      background-color: rgb(234, 111, 124);
    }

    .gm5 {
      background-color: rgb(246, 15, 32);
    }

    div#del-list {
      min-height: 200px;
    }

    .content {
      padding: 10px;
    }
    span.next_sentence.original {
    background: #e44e4e;
}
    .edit_box_textarea {
      height: 6em !important;
      min-height: 2em !important;
      max-height: 24em;
      width: 100%;
    }

    .edit_box_form {
      height: 100px;
      overflow-y: hidden;
    }

    .open_edit_box {
      height: 500px;
      background: #fbf9f9;
    }

    .open_edit_box .edit_box_form {
      height: 400px;
      overflow-y: auto;
    }

    .edit_box {
      /* padding: 10px 100px 10px 10px !important;
  border: 1px solid #ccc;
    border-radius: 5px; */
      /* padding-left: 100px !important; */
      background: #efefef !important;
    }

    .article {
      margin: 50px;
    }

    .sentence {
      /* 语句样式 */
      padding: 5px;
      background: #f1f1f1;
      margin-right: 20px;
      line-height: 35px;
    }

    .summary {
      background: #a1cca5;
    }

    span.red,
    span.sentence.red {
      background: #f54c4c;
    }


    body.dragging,
    body.dragging * {
      cursor: move !important;
    }

    #edit-list li {
      border: #d4d4d4 1px solid;
      margin: 5px;
      padding: 10px;
      background: #fff;
    }

    #edit-list li.editing,
    .editing {
      background: #f5814e;
    }
    div#calculate_list {
    min-height: 100px;
}
    ol#edit-list {
      height: 600px;
      background: #f1efef;
      border-radius: 4px;
      padding: 10px 20px;
      overflow-y: auto;
    }
    div#editing_juzi_edit_ppl {
    padding: 15px;
}
    .word {
      padding: 5px;

      background: #eae7e7;
      line-height: 40px;
      border-radius: 2px;
      margin: 5px !important;


    }

    .placeholder {
      display: inline-block;
      width: 100%;
      background: #21ba45 !important;
    }

    .keywords {
      font-size: 1.5em;
      border: solid 1px #ccc;
      padding: 10px;
      margin: 10px 0;
    }

    div#editing_juzi {
      background: #333;
      padding: 10px;
      margin-bottom: 10px;
    }

    div#editing_box {
      margin: 0;
      min-height: 400px;
    }

    div#calculate_list li {
      margin: 10px;
    }
    .pre_line {
    font-size: 1.5em;
}
.edited{
  border-bottom: 2px solid #f2711c !important;
}
    .dragged {
      position: absolute;
      opacity: 0.5;
      z-index: 2000;
      background: #36d65c;
      left: 0;
      top: 0;
    }

    ol.example li.placeholder {
      position: relative;
      /** More li styles **/
    }

    ol.example li.placeholder:before {
      position: absolute;
      /** Define arrowhead **/
    }

    
  </style>

</head>

<body>


  <div class="ui fixed inverted menu">
    <div class="ui container">
      <a href="/" class="header item">

        写作助手
      </a>

    </div>
  </div>






  <div class="ui two column stackable grid">

    <div class="ten wide column">
   
      <div class="content">

   <!-- 搜索盒子 -->
   <div id = 'search-box' class="ui form">
 
      <div class="ui action input">
        <!-- <label>搜索资料</label> -->
        <input id="search-input" type="text" placeholder="搜索...">
        <button id="search-button" class="ui button">搜索</button>

        <!-- <label>搜索资料</label> -->
     
      </div>
    </div>
     <!-- 搜索盒子 -->

        <div class="ui segment">
         
          <ol id='edit-list' class='serialization vertical'>

            <!-- <li data-id='3' data-name='Item 4'>
              段落
              <ol>


              </ol>
            </li>
            <li>
              段落
              <ol>

              </ol>
            </li>

            <li>
              段落
              <ol>

              </ol>
            </li>

            <li>
              段落
              <ol>

              </ol>
            </li>

            <li>
              段落
              <ol>

              </ol>
            </li> -->
          </ol>


          <!-- <ol class='serialization vertical'>
            <li data-id='0' data-name='Item 1'>Item 1</li>
            <li data-id='1' data-name='Item 2'>Item 2</li>
            <li data-id='2' data-name='Item 3'>Item 3</li>
            <li data-id='3' data-name='Item 4'>Item 4</li>
            <li data-id='4' data-name='Item 5'>Item 5</li>
            <li data-id='5' data-name='Item 6'>Item 6</li>
          </ol> -->



          <form class="ui reply form">
            <div class="ui middle aligned divided list list-group-sortable-connected" id="edit-list-warp">
              <h2>编辑器</h2>
            

            </div>
          </form>
          <div class="ui form">
            <textarea id="add_juzi_edit" rows="3" cols="20"> </textarea>

            <button id="add_juzi_edit_btn" class="ui green button">添加语句</button>
            <button id="show_add_url" class="ui green button">添加素材</button>
            <button id="used" class="ui green button">标记使用</button>
            <button id="auto_sort" class="ui green button">Ai排序</button>
            <a href="/p/edit"  class="ui green button">创建内容</a>
            
          </div>




        </div>
      </div>




      <!-- 获取数据 -->
      <div class="ui segment">
          <h3 id="slist_msg"></h3>
          <div id="slist" class="column ui segment">
    
          </div>
     
        </div>

      <!-- end获取数据 -->




















    </div>
    <div class="six wide column">












      <!-- 这里是句子编辑 -->
      <div id="editing_box">
        <!-- 这里包含当前选择的语句id -->
        <!-- <input id='p_juzi1' type="hidden" > -->
        <input id='t_juzi' type="hidden">
        <!-- <input id='n_juzi1' type="hidden" > -->
        <!-- editing_juzi -->
        <div class="ui form">
            <h3>Ai审查语句流畅度：</h3>

            <p class="gm-dengji">
              等级1<span class='gm1 gm'></span>
              等级2<span class='gm2 gm'></span>
              等级3<span class='gm3 gm'></span>
              等级4<span class='gm4 gm'></span>
              等级5<span class='gm5 gm'></span></p>
          <textarea id="editing_juzi_edit" rows="3" cols="20">
          </textarea>

          <ol id="edit_tool" class='serialization'>
          </ol>
          </div>
 
            <div id="editing_juzi_edit_ppl_value" class="">
                <div class="label">
                    PPL(越低越流畅 建议小于500)
                  </div>
                    <div class="value">
                      0
                    </div>
               </div>
        
        <div id="editing_juzi_edit_ppl"></div>
     
        <!-- <ul class="ui inverted segment" id="editing_juzi">


        </ul> -->
        <div id="editing_word_box">

          <div class="ui form">
            <input id='wordid' type="hidden" name="wordid" value>
            <!-- <div class="field">
              <label>词语</label>
              <input id='word_text' type="text" name="word_text">
            </div> -->

            <!-- <div class="field">
              <div class="ui checkbox">
                <input type="checkbox" tabindex="0" class="hidden">
                <label>I agree to the Terms and Conditions</label>
              </div>
            </div> -->

            <!-- <button id='up' class="ui red button " type="submit">提交</button>
            <button id='addpre' class="ui orange button">添加到前面</button>
            <button id='addnext' class="ui yellow button">添加到之后</button>
            <button id='remove' class="ui olive button">删除</button> -->
            <button id='fenci_update' class="ui red button">add样本</button>
            <button id='nlp' class="ui green button">nlp</button>
            <button id='mask' class="ui green button">预测</button>
            <button id='gaicuo' class="ui green button">改错</button>
            <button id='del_s' class="ui green button">删除这句</button>
           

     
            <div class="field">
              <label>下一句关键词</label>
              <input id="calculate_keyword" type="text" name="calculate_keyword" placeholder="下一句关键词">
            </div>
            <button id='next' class="ui green button">猜下一句</button>
            


          </div>
        </div>
          <!-- 这里是预测结果的地方 -->
          <!-- <h3>预测下一句为</h3> -->
    
        
            <h3 id="calculate_list_msg" class="ui segment"></h3>  
        
       
          <div id="calculate_list" class="ui segment">


          </div>

          <div id="search-tags" class="ui segment column">
    
            
            </div>
            <div id="search-keyphrases" class="ui segment column">
    
      
              </div>

          <!-- 获取text -->
          <div id="target">

              <button id="totext" class="ui button">
                获取text
              </button>
              <span id = "totext_lab">字数:</span>
              <span id = "totext_len"></span>
            </div>
         
    
          <div id="content-review" class="ui segment column">
    
            <div class="content">
    
    
            </div>
          </div>
      
      
       
       
       
       
       
        </div>

   

      <!-- 句子编辑结束 -->

 

    </div>
  </div>

  <div class="column">













<!-- 这里是弹出层 -->

<div id = 'yw-modal' class="ui modal">
  <i class="close icon"></i>
  <div class="header">
    原文
  </div>
  <div class=" content">
    <!-- <div class="ui medium image">
      <img src="/images/avatar/large/chris.jpg">
    </div> -->
    <div class="pre_line">
 
      </div>
      <!-- <div class="this_line">
 
     </div> -->
    <div class="article">
 
    </div>
  </div>
  <div class="actions">
    <!-- <div class="ui black deny button">
      Nope
    </div> -->
    <div class="ui positive right labeled icon button">
     关闭
      <i class="checkmark icon"></i>
    </div>
  </div>
</div>






<!-- 这里是添加url_text弹出层 -->

<div id = 'url_text-modal' class="ui modal">
  <i class="close icon"></i>
  <div class="header">
    添加素材
  </div>
  <div class=" content">

    <div id='add-sucai' class="ui form">
      <div class="field">
        <label>url</label>
        <input class='url' type="text" name="url" placeholder="网页地址">
      </div>
      <div class="field">
        <label>关键词</label>
        <input class='kwd' type="text" name="kwd" placeholder="关键词">
      </div>

      <div class="field">
        <label>文本</label>
        <textarea class='text'></textarea>
      </div>

      <!-- <div class="field">
        <div class="ui checkbox">
          <input type="checkbox" tabindex="0" class="hidden">
          <label>I agree to the Terms and Conditions</label>
        </div>
      </div> -->
      <button id='' class="submit ui button" type="submit">Submit</button>
    </div>















    <div class="baidu_list">
 
      </div>
      <!-- <div class="this_line">
 
     </div> -->
    <div class="article">
 
    </div>
  </div>
  <div class="actions">
    <!-- <div class="ui black deny button">
      Nope
    </div> -->
    <div class="ui positive right labeled icon button">
     关闭
      <i class="checkmark icon"></i>
    </div>
  </div>
</div>















<!-- 这里是添加url_text弹出层 -->

<div id = 'add-title-modal' class="ui modal">
  <i class="close icon"></i>
  <div class="header">
    请填写标题
  </div>
  <div class=" content">
 
    <div class="article ui form">
      <input id="save_post_title-input" type="text" placeholder="输入标题...">
      <button id="save_post-button" class="ui button">提交</button>
    </div>
  </div>
  <div class="actions">
    <!-- <div class="ui black deny button">
      Nope
    </div> -->
    <div class="ui positive right labeled icon button">
     关闭
      <i class="checkmark icon"></i>
    </div>
  </div>
</div>
















</body>

</html>